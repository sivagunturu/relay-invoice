{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/lib/actions/organizations.ts"],"sourcesContent":["'use server';\n\nimport { createClient as createSupabaseClient } from '@/lib/supabase/server';\nimport { getUser } from './auth';\n\nexport async function getUserOrganization() {\n  const supabase = await createSupabaseClient();\n  const user = await getUser();\n\n  if (!user) {\n    console.log('No user found');\n    return null;\n  }\n\n  console.log('Fetching org for user:', user.id);\n\n  // Step 1: Get the org_member record\n  const { data: membership, error: memberError } = await supabase\n    .from('org_members')\n    .select('id, role, status, org_id')\n    .eq('user_id', user.id)\n    .eq('status', 'active')\n    .single();\n\n  if (memberError || !membership) {\n    console.error('Error fetching membership:', memberError);\n    return null;\n  }\n\n  console.log('Found membership:', membership);\n\n  // Step 2: Get the organization\n  const { data: org, error: orgError } = await supabase\n    .from('organizations')\n    .select('id, name, created_at')\n    .eq('id', membership.org_id)\n    .single();\n\n  if (orgError || !org) {\n    console.error('Error fetching organization:', orgError);\n    return null;\n  }\n\n  console.log('Found organization:', org);\n\n  return {\n    id: org.id,\n    name: org.name,\n    role: membership.role,\n  };\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,gJAAoB;IAC3C,MAAM,OAAO,MAAM,IAAA,wIAAO;IAE1B,IAAI,CAAC,MAAM;QACT,QAAQ,GAAG,CAAC;QACZ,OAAO;IACT;IAEA,QAAQ,GAAG,CAAC,0BAA0B,KAAK,EAAE;IAE7C,oCAAoC;IACpC,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SACpD,IAAI,CAAC,eACL,MAAM,CAAC,4BACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,EAAE,CAAC,UAAU,UACb,MAAM;IAET,IAAI,eAAe,CAAC,YAAY;QAC9B,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;IAEA,QAAQ,GAAG,CAAC,qBAAqB;IAEjC,+BAA+B;IAC/B,MAAM,EAAE,MAAM,GAAG,EAAE,OAAO,QAAQ,EAAE,GAAG,MAAM,SAC1C,IAAI,CAAC,iBACL,MAAM,CAAC,wBACP,EAAE,CAAC,MAAM,WAAW,MAAM,EAC1B,MAAM;IAET,IAAI,YAAY,CAAC,KAAK;QACpB,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;IACT;IAEA,QAAQ,GAAG,CAAC,uBAAuB;IAEnC,OAAO;QACL,IAAI,IAAI,EAAE;QACV,MAAM,IAAI,IAAI;QACd,MAAM,WAAW,IAAI;IACvB;AACF;;;IA7CsB;;AAAA,+OAAA"}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/lib/actions/settings.ts"],"sourcesContent":["'use server';\n\nimport { createClient as createSupabaseClient } from '@/lib/supabase/server';\nimport { getUserOrganization } from './organizations';\nimport { settingsSchema } from '../validations/schemas';\nimport { revalidatePath } from 'next/cache';\n\nexport async function getSettings() {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { data, error } = await supabase\n    .from('org_settings')\n    .select('*')\n    .eq('org_id', org.id)\n    .single();\n\n  if (error) throw new Error(error.message);\n  return data;\n}\n\nexport async function updateSettings(formData: FormData) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const paymentInstructions = {\n    payable_to: formData.get('payable_to') as string,\n    bank_name: formData.get('bank_name') as string,\n    routing_number: formData.get('routing_number') as string,\n    account_number: formData.get('account_number') as string,\n  };\n\n  const { error } = await supabase\n    .from('org_settings')\n    .update({\n      company_name: formData.get('companyName') as string,\n      address_line1: formData.get('addressLine1') as string,\n      address_line2: formData.get('addressLine2') as string,\n      address_line3: formData.get('addressLine3') as string,\n      email: formData.get('email') as string,\n      phone: formData.get('phone') as string,\n      default_terms: formData.get('defaultTerms') as string,\n      default_currency: formData.get('defaultCurrency') as string,\n      invoice_prefix: formData.get('invoicePrefix') as string,\n      footer_note: formData.get('footerNote') as string,\n      payment_instructions: paymentInstructions,\n      compliance_text: formData.get('complianceText') as string,\n    })\n    .eq('org_id', org.id);\n\n  if (error) throw new Error(error.message);\n\n  revalidatePath('/settings');\n  return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;;;;;;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,gJAAoB;IAC3C,MAAM,MAAM,MAAM,IAAA,6JAAmB;IAErC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,gBACL,MAAM,CAAC,KACP,EAAE,CAAC,UAAU,IAAI,EAAE,EACnB,MAAM;IAET,IAAI,OAAO,MAAM,IAAI,MAAM,MAAM,OAAO;IACxC,OAAO;AACT;AAEO,eAAe,eAAe,QAAkB;IACrD,MAAM,WAAW,MAAM,IAAA,gJAAoB;IAC3C,MAAM,MAAM,MAAM,IAAA,6JAAmB;IAErC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,MAAM,sBAAsB;QAC1B,YAAY,SAAS,GAAG,CAAC;QACzB,WAAW,SAAS,GAAG,CAAC;QACxB,gBAAgB,SAAS,GAAG,CAAC;QAC7B,gBAAgB,SAAS,GAAG,CAAC;IAC/B;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,gBACL,MAAM,CAAC;QACN,cAAc,SAAS,GAAG,CAAC;QAC3B,eAAe,SAAS,GAAG,CAAC;QAC5B,eAAe,SAAS,GAAG,CAAC;QAC5B,eAAe,SAAS,GAAG,CAAC;QAC5B,OAAO,SAAS,GAAG,CAAC;QACpB,OAAO,SAAS,GAAG,CAAC;QACpB,eAAe,SAAS,GAAG,CAAC;QAC5B,kBAAkB,SAAS,GAAG,CAAC;QAC/B,gBAAgB,SAAS,GAAG,CAAC;QAC7B,aAAa,SAAS,GAAG,CAAC;QAC1B,sBAAsB;QACtB,iBAAiB,SAAS,GAAG,CAAC;IAChC,GACC,EAAE,CAAC,UAAU,IAAI,EAAE;IAEtB,IAAI,OAAO,MAAM,IAAI,MAAM,MAAM,OAAO;IAExC,IAAA,+IAAc,EAAC;IACf,OAAO;QAAE,SAAS;IAAK;AACzB;;;IAnDsB;IAgBA;;AAhBA,+OAAA;AAgBA,+OAAA"}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/lib/actions/logo.ts"],"sourcesContent":["'use server';\n\nimport { createClient as createSupabaseClient } from '@/lib/supabase/server';\nimport { getUserOrganization } from './organizations';\nimport { revalidatePath } from 'next/cache';\n\nexport async function uploadLogo(formData: FormData) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const file = formData.get('logo') as File;\n  if (!file) throw new Error('No file provided');\n\n  // Validate file type\n  if (!file.type.startsWith('image/')) {\n    throw new Error('File must be an image');\n  }\n\n  // Validate file size (max 2MB)\n  if (file.size > 2 * 1024 * 1024) {\n    throw new Error('File size must be less than 2MB');\n  }\n\n  const fileExt = file.name.split('.').pop();\n  const fileName = `${org.id}/logo.${fileExt}`;\n\n  // Upload to storage\n  const { data: uploadData, error: uploadError } = await supabase.storage\n    .from('logos')\n    .upload(fileName, file, {\n      upsert: true,\n      contentType: file.type,\n    });\n\n  if (uploadError) throw new Error(uploadError.message);\n\n  // Get public URL\n  const { data: { publicUrl } } = supabase.storage\n    .from('logos')\n    .getPublicUrl(fileName);\n\n  // Update org_settings with logo path\n  const { error: updateError } = await supabase\n    .from('org_settings')\n    .update({ logo_url: publicUrl })\n    .eq('org_id', org.id);\n\n  if (updateError) throw new Error(updateError.message);\n\n  revalidatePath('/settings');\n  return { success: true, logoUrl: publicUrl };\n}\n\nexport async function deleteLogo() {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const fileName = `${org.id}/logo`;\n\n  // Delete from storage (try all common extensions)\n  const extensions = ['png', 'jpg', 'jpeg', 'gif', 'webp'];\n  for (const ext of extensions) {\n    await supabase.storage.from('logos').remove([`${fileName}.${ext}`]);\n  }\n\n  // Update org_settings\n  const { error } = await supabase\n    .from('org_settings')\n    .update({ logo_url: null })\n    .eq('org_id', org.id);\n\n  if (error) throw new Error(error.message);\n\n  revalidatePath('/settings');\n  return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;;;;;;AAEO,eAAe,WAAW,QAAkB;IACjD,MAAM,WAAW,MAAM,IAAA,gJAAoB;IAC3C,MAAM,MAAM,MAAM,IAAA,6JAAmB;IAErC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,qBAAqB;IACrB,IAAI,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW;QACnC,MAAM,IAAI,MAAM;IAClB;IAEA,+BAA+B;IAC/B,IAAI,KAAK,IAAI,GAAG,IAAI,OAAO,MAAM;QAC/B,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;IACxC,MAAM,WAAW,GAAG,IAAI,EAAE,CAAC,MAAM,EAAE,SAAS;IAE5C,oBAAoB;IACpB,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAAS,OAAO,CACpE,IAAI,CAAC,SACL,MAAM,CAAC,UAAU,MAAM;QACtB,QAAQ;QACR,aAAa,KAAK,IAAI;IACxB;IAEF,IAAI,aAAa,MAAM,IAAI,MAAM,YAAY,OAAO;IAEpD,iBAAiB;IACjB,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,GAAG,SAAS,OAAO,CAC7C,IAAI,CAAC,SACL,YAAY,CAAC;IAEhB,qCAAqC;IACrC,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAClC,IAAI,CAAC,gBACL,MAAM,CAAC;QAAE,UAAU;IAAU,GAC7B,EAAE,CAAC,UAAU,IAAI,EAAE;IAEtB,IAAI,aAAa,MAAM,IAAI,MAAM,YAAY,OAAO;IAEpD,IAAA,+IAAc,EAAC;IACf,OAAO;QAAE,SAAS;QAAM,SAAS;IAAU;AAC7C;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,gJAAoB;IAC3C,MAAM,MAAM,MAAM,IAAA,6JAAmB;IAErC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,MAAM,WAAW,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC;IAEjC,kDAAkD;IAClD,MAAM,aAAa;QAAC;QAAO;QAAO;QAAQ;QAAO;KAAO;IACxD,KAAK,MAAM,OAAO,WAAY;QAC5B,MAAM,SAAS,OAAO,CAAC,IAAI,CAAC,SAAS,MAAM,CAAC;YAAC,GAAG,SAAS,CAAC,EAAE,KAAK;SAAC;IACpE;IAEA,sBAAsB;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,gBACL,MAAM,CAAC;QAAE,UAAU;IAAK,GACxB,EAAE,CAAC,UAAU,IAAI,EAAE;IAEtB,IAAI,OAAO,MAAM,IAAI,MAAM,MAAM,OAAO;IAExC,IAAA,+IAAc,EAAC;IACf,OAAO;QAAE,SAAS;IAAK;AACzB;;;IAzEsB;IAiDA;;AAjDA,+OAAA;AAiDA,+OAAA"}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/.next-internal/server/app/%28dashboard%29/settings/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logout as '000103f9874b7040b8d4cbbc620486096206d2ac25'} from 'ACTIONS_MODULE0'\nexport {getUser as '0086a0370c203ea1533a70f33d44e12071457751c5'} from 'ACTIONS_MODULE0'\nexport {login as '4074b1ed48e46d3f6aba76d994e833378f65764ade'} from 'ACTIONS_MODULE0'\nexport {signUp as '40b0a4c873012936c9193d892ed73bf486509d8178'} from 'ACTIONS_MODULE0'\nexport {logout as '000103f9874b7040b8d4cbbc620486096206d2ac25'} from 'ACTIONS_MODULE0'\nexport {getSettings as '006f0efb7ff88f7690cc8915386c6d52386ff411eb'} from 'ACTIONS_MODULE1'\nexport {updateSettings as '403fe2cbd6cc6474ac25d7a5b8c51654d0a02dd7a4'} from 'ACTIONS_MODULE1'\nexport {getUserOrganization as '0075c59babaf1e4bd99e17674d8556a7957a4dad3b'} from 'ACTIONS_MODULE2'\nexport {uploadLogo as '404a1deb140823f67ce5a6e4d5337c44f1af99f5b8'} from 'ACTIONS_MODULE3'\nexport {deleteLogo as '00738831b8ee64649a1f19a51d3e2f166fb34fce38'} from 'ACTIONS_MODULE3'\n"],"names":[],"mappings":";AAAA;AAKA;AAEA;AACA"}}]
}