{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/lib/actions/templates.ts"],"sourcesContent":["'use server';\n\nimport { createClient as createSupabaseClient } from '@/lib/supabase/server';\nimport { getUserOrganization } from './organizations';\nimport { revalidatePath } from 'next/cache';\nimport { redirect } from 'next/navigation';\nimport { getNextMonthStart } from '../utils';\n\nexport async function getTemplates() {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { data, error } = await supabase\n    .from('invoice_templates')\n    .select(`\n      *,\n      clients (id, name)\n    `)\n    .eq('org_id', org.id)\n    .order('name');\n\n  if (error) throw new Error(error.message);\n  return data;\n}\n\nexport async function getTemplate(id: string) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { data, error } = await supabase\n    .from('invoice_templates')\n    .select(`\n      *,\n      clients (id, name),\n      invoice_template_items (\n        *,\n        consultants (id, name)\n      )\n    `)\n    .eq('id', id)\n    .eq('org_id', org.id)\n    .single();\n\n  if (error) throw new Error(error.message);\n  return data;\n}\n\nexport async function createTemplate(formData: FormData) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const clientId = formData.get('clientId') as string;\n  const name = formData.get('name') as string;\n  const dayOfMonth = parseInt(formData.get('dayOfMonth') as string);\n  const autoSend = formData.get('autoSend') === 'true';\n\n  const nextRunAt = getNextMonthStart(dayOfMonth);\n\n  const { data: template, error: templateError } = await supabase\n    .from('invoice_templates')\n    .insert({\n      org_id: org.id,\n      client_id: clientId,\n      name,\n      day_of_month: dayOfMonth,\n      next_run_at: nextRunAt.toISOString(),\n      auto_send: autoSend,\n    })\n    .select()\n    .single();\n\n  if (templateError) throw new Error(templateError.message);\n\n  // Parse items from formData\n  const itemsJson = formData.get('items') as string;\n  if (itemsJson) {\n    const items = JSON.parse(itemsJson);\n    const itemsToInsert = items.map((item: any, index: number) => ({\n      org_id: org.id,\n      template_id: template.id,\n      consultant_id: item.consultantId || null,\n      description: item.description,\n      qty_default: item.qtyDefault || 0,\n      rate_default: item.rateDefault,\n      sort_order: index,\n    }));\n\n    const { error: itemsError } = await supabase\n      .from('invoice_template_items')\n      .insert(itemsToInsert);\n\n    if (itemsError) throw new Error(itemsError.message);\n  }\n\n  revalidatePath('/templates');\n  redirect('/templates');\n}\n\nexport async function updateTemplate(id: string, formData: FormData) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const clientId = formData.get('clientId') as string;\n  const name = formData.get('name') as string;\n  const dayOfMonth = parseInt(formData.get('dayOfMonth') as string);\n  const autoSend = formData.get('autoSend') === 'true';\n\n  const { error: templateError } = await supabase\n    .from('invoice_templates')\n    .update({\n      client_id: clientId,\n      name,\n      day_of_month: dayOfMonth,\n      auto_send: autoSend,\n    })\n    .eq('id', id)\n    .eq('org_id', org.id);\n\n  if (templateError) throw new Error(templateError.message);\n\n  // Delete existing items\n  await supabase\n    .from('invoice_template_items')\n    .delete()\n    .eq('template_id', id);\n\n  // Insert new items\n  const itemsJson = formData.get('items') as string;\n  if (itemsJson) {\n    const items = JSON.parse(itemsJson);\n    const itemsToInsert = items.map((item: any, index: number) => ({\n      org_id: org.id,\n      template_id: id,\n      consultant_id: item.consultantId || null,\n      description: item.description,\n      qty_default: item.qtyDefault || 0,\n      rate_default: item.rateDefault,\n      sort_order: index,\n    }));\n\n    const { error: itemsError } = await supabase\n      .from('invoice_template_items')\n      .insert(itemsToInsert);\n\n    if (itemsError) throw new Error(itemsError.message);\n  }\n\n  revalidatePath('/templates');\n  redirect('/templates');\n}\n\nexport async function deleteTemplate(id: string) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { error } = await supabase\n    .from('invoice_templates')\n    .delete()\n    .eq('id', id)\n    .eq('org_id', org.id);\n\n  if (error) throw new Error(error.message);\n\n  revalidatePath('/templates');\n  return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;MAwGsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,kDAAA"}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/lib/actions/templates.ts"],"sourcesContent":["'use server';\n\nimport { createClient as createSupabaseClient } from '@/lib/supabase/server';\nimport { getUserOrganization } from './organizations';\nimport { revalidatePath } from 'next/cache';\nimport { redirect } from 'next/navigation';\nimport { getNextMonthStart } from '../utils';\n\nexport async function getTemplates() {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { data, error } = await supabase\n    .from('invoice_templates')\n    .select(`\n      *,\n      clients (id, name)\n    `)\n    .eq('org_id', org.id)\n    .order('name');\n\n  if (error) throw new Error(error.message);\n  return data;\n}\n\nexport async function getTemplate(id: string) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { data, error } = await supabase\n    .from('invoice_templates')\n    .select(`\n      *,\n      clients (id, name),\n      invoice_template_items (\n        *,\n        consultants (id, name)\n      )\n    `)\n    .eq('id', id)\n    .eq('org_id', org.id)\n    .single();\n\n  if (error) throw new Error(error.message);\n  return data;\n}\n\nexport async function createTemplate(formData: FormData) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const clientId = formData.get('clientId') as string;\n  const name = formData.get('name') as string;\n  const dayOfMonth = parseInt(formData.get('dayOfMonth') as string);\n  const autoSend = formData.get('autoSend') === 'true';\n\n  const nextRunAt = getNextMonthStart(dayOfMonth);\n\n  const { data: template, error: templateError } = await supabase\n    .from('invoice_templates')\n    .insert({\n      org_id: org.id,\n      client_id: clientId,\n      name,\n      day_of_month: dayOfMonth,\n      next_run_at: nextRunAt.toISOString(),\n      auto_send: autoSend,\n    })\n    .select()\n    .single();\n\n  if (templateError) throw new Error(templateError.message);\n\n  // Parse items from formData\n  const itemsJson = formData.get('items') as string;\n  if (itemsJson) {\n    const items = JSON.parse(itemsJson);\n    const itemsToInsert = items.map((item: any, index: number) => ({\n      org_id: org.id,\n      template_id: template.id,\n      consultant_id: item.consultantId || null,\n      description: item.description,\n      qty_default: item.qtyDefault || 0,\n      rate_default: item.rateDefault,\n      sort_order: index,\n    }));\n\n    const { error: itemsError } = await supabase\n      .from('invoice_template_items')\n      .insert(itemsToInsert);\n\n    if (itemsError) throw new Error(itemsError.message);\n  }\n\n  revalidatePath('/templates');\n  redirect('/templates');\n}\n\nexport async function updateTemplate(id: string, formData: FormData) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const clientId = formData.get('clientId') as string;\n  const name = formData.get('name') as string;\n  const dayOfMonth = parseInt(formData.get('dayOfMonth') as string);\n  const autoSend = formData.get('autoSend') === 'true';\n\n  const { error: templateError } = await supabase\n    .from('invoice_templates')\n    .update({\n      client_id: clientId,\n      name,\n      day_of_month: dayOfMonth,\n      auto_send: autoSend,\n    })\n    .eq('id', id)\n    .eq('org_id', org.id);\n\n  if (templateError) throw new Error(templateError.message);\n\n  // Delete existing items\n  await supabase\n    .from('invoice_template_items')\n    .delete()\n    .eq('template_id', id);\n\n  // Insert new items\n  const itemsJson = formData.get('items') as string;\n  if (itemsJson) {\n    const items = JSON.parse(itemsJson);\n    const itemsToInsert = items.map((item: any, index: number) => ({\n      org_id: org.id,\n      template_id: id,\n      consultant_id: item.consultantId || null,\n      description: item.description,\n      qty_default: item.qtyDefault || 0,\n      rate_default: item.rateDefault,\n      sort_order: index,\n    }));\n\n    const { error: itemsError } = await supabase\n      .from('invoice_template_items')\n      .insert(itemsToInsert);\n\n    if (itemsError) throw new Error(itemsError.message);\n  }\n\n  revalidatePath('/templates');\n  redirect('/templates');\n}\n\nexport async function deleteTemplate(id: string) {\n  const supabase = await createSupabaseClient();\n  const org = await getUserOrganization();\n\n  if (!org) throw new Error('No organization found');\n\n  const { error } = await supabase\n    .from('invoice_templates')\n    .delete()\n    .eq('id', id)\n    .eq('org_id', org.id);\n\n  if (error) throw new Error(error.message);\n\n  revalidatePath('/templates');\n  return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;MA+JsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,kDAAA"}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/components/ui/card.tsx"],"sourcesContent":["import { ReactNode } from 'react';\n\nexport function Card({ children, className = '' }: { children: ReactNode; className?: string }) {\n  return (\n    <div className={`bg-white rounded-lg shadow p-6 ${className}`}>\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAEO,SAAS,KAAK,EAAE,QAAQ,EAAE,YAAY,EAAE,EAA+C;IAC5F,qBACE,8OAAC;QAAI,WAAW,CAAC,+BAA+B,EAAE,WAAW;kBAC1D;;;;;;AAGP"}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/components/ui/input.tsx"],"sourcesContent":["import { InputHTMLAttributes } from 'react';\n\ninterface InputProps extends InputHTMLAttributes<HTMLInputElement> {\n  label?: string;\n}\n\nexport function Input({ label, className = '', ...props }: InputProps) {\n  return (\n    <div className=\"mb-4\">\n      {label && (\n        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n          {label}\n        </label>\n      )}\n      <input\n        className={`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${className}`}\n        {...props}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAMO,SAAS,MAAM,EAAE,KAAK,EAAE,YAAY,EAAE,EAAE,GAAG,OAAmB;IACnE,qBACE,8OAAC;QAAI,WAAU;;YACZ,uBACC,8OAAC;gBAAM,WAAU;0BACd;;;;;;0BAGL,8OAAC;gBACC,WAAW,CAAC,uGAAuG,EAAE,WAAW;gBAC/H,GAAG,KAAK;;;;;;;;;;;;AAIjB"}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/components/ui/button.tsx"],"sourcesContent":["import { ButtonHTMLAttributes } from 'react';\n\ninterface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: 'primary' | 'secondary' | 'danger';\n}\n\nexport function Button({ variant = 'primary', className = '', ...props }: ButtonProps) {\n  const baseStyles = 'px-4 py-2 rounded-md font-medium transition-colors';\n  const variants = {\n    primary: 'bg-blue-600 text-white hover:bg-blue-700',\n    secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300',\n    danger: 'bg-red-600 text-white hover:bg-red-700',\n  };\n\n  return (\n    <button\n      className={`${baseStyles} ${variants[variant]} ${className}`}\n      {...props}\n    />\n  );\n}\n"],"names":[],"mappings":";;;;;;AAMO,SAAS,OAAO,EAAE,UAAU,SAAS,EAAE,YAAY,EAAE,EAAE,GAAG,OAAoB;IACnF,MAAM,aAAa;IACnB,MAAM,WAAW;QACf,SAAS;QACT,WAAW;QACX,QAAQ;IACV;IAEA,qBACE,8OAAC;QACC,WAAW,GAAG,WAAW,CAAC,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC,EAAE,WAAW;QAC3D,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/sivagunturu/Documents/relay-invoice/src/app/%28dashboard%29/templates/%5Bid%5D/edit/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { updateTemplate, deleteTemplate } from '@/lib/actions/templates';\nimport { Card } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport Link from 'next/link';\n\nexport default function EditTemplatePage({ params }: { params: { id: string } }) {\n  const [items, setItems] = useState([{ consultantId: '', description: '', qtyDefault: 0, rateDefault: 0 }]);\n\n  function addItem() {\n    setItems([...items, { consultantId: '', description: '', qtyDefault: 0, rateDefault: 0 }]);\n  }\n\n  function removeItem(index: number) {\n    setItems(items.filter((_, i) => i !== index));\n  }\n\n  async function handleSubmit(formData: FormData) {\n    formData.append('items', JSON.stringify(items));\n    await updateTemplate(params.id, formData);\n  }\n\n  async function handleDelete() {\n    if (confirm('Are you sure you want to delete this template?')) {\n      await deleteTemplate(params.id);\n    }\n  }\n\n  return (\n    <div className=\"max-w-3xl\">\n      <h1 className=\"text-3xl font-bold mb-8\">Edit Template</h1>\n\n      <Card>\n        <form action={handleSubmit}>\n          <Input label=\"Template Name *\" name=\"name\" required />\n          <Input label=\"Client ID *\" name=\"clientId\" required />\n          <Input label=\"Day of Month (1-28) *\" name=\"dayOfMonth\" type=\"number\" min=\"1\" max=\"28\" required />\n          \n          <div className=\"mb-4\">\n            <label className=\"flex items-center\">\n              <input type=\"checkbox\" name=\"autoSend\" value=\"true\" className=\"mr-2\" />\n              <span className=\"text-sm font-medium text-gray-700\">Auto-send</span>\n            </label>\n          </div>\n\n          <div className=\"border-t pt-4 mt-6\">\n            <h3 className=\"font-semibold mb-4\">Template Items</h3>\n            {items.map((item, index) => (\n              <div key={index} className=\"border p-4 mb-4 rounded\">\n                <Input \n                  label=\"Description *\" \n                  value={item.description}\n                  onChange={(e) => {\n                    const newItems = [...items];\n                    newItems[index].description = e.target.value;\n                    setItems(newItems);\n                  }}\n                  required\n                />\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <Input \n                    label=\"Default Qty\" \n                    type=\"number\"\n                    step=\"0.01\"\n                    value={item.qtyDefault}\n                    onChange={(e) => {\n                      const newItems = [...items];\n                      newItems[index].qtyDefault = parseFloat(e.target.value) || 0;\n                      setItems(newItems);\n                    }}\n                  />\n                  <Input \n                    label=\"Default Rate *\" \n                    type=\"number\"\n                    step=\"0.01\"\n                    value={item.rateDefault}\n                    onChange={(e) => {\n                      const newItems = [...items];\n                      newItems[index].rateDefault = parseFloat(e.target.value) || 0;\n                      setItems(newItems);\n                    }}\n                    required\n                  />\n                </div>\n                {items.length > 1 && (\n                  <Button \n                    type=\"button\" \n                    variant=\"danger\" \n                    onClick={() => removeItem(index)}\n                    className=\"text-sm mt-2\"\n                  >\n                    Remove Item\n                  </Button>\n                )}\n              </div>\n            ))}\n            <Button type=\"button\" variant=\"secondary\" onClick={addItem}>\n              Add Item\n            </Button>\n          </div>\n\n          <div className=\"flex gap-4 mt-6\">\n            <Button type=\"submit\">Update Template</Button>\n            <Link href=\"/templates\">\n              <Button type=\"button\" variant=\"secondary\">Cancel</Button>\n            </Link>\n            <Button type=\"button\" variant=\"danger\" onClick={handleDelete} className=\"ml-auto\">\n              Delete Template\n            </Button>\n          </div>\n        </form>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}